<HTML>
<HEAD>
<META HTTP-EQUIV="pragma" CONTENT="no-cache">
<META http-equiv=content-type content=text/html;charset=<%nvram_get("charset");%>>
<SCRIPT language=Javascript src="language_<%nvram_get("lang_code");%>.js"></SCRIPT>
<META HTTP-EQUIV="expires" CONTENT="0">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
<LINK href="styles.css" type=text/css rel=stylesheet>
<SCRIPT>assign_var();</SCRIPT>
<SCRIPT language=JavaScript src="showMenu.js"></SCRIPT>
<SCRIPT>
strHtml='<title>'+show50+'</title>';
dw(strHtml);
<!--
var helpItem 	='Guest Access';
var menuSection	='WLAN';
var menuItem	='Guest Access';
var isAPmode = ('<%nvram_get("wan_enabled");%>' == '0') ? '1' : '0';
var cty_lang_code='<%nvram_get("lang_code");%>';
<%autofw_check();%>
<!--
function GURL(x){location=x}

function change_psk()
{
	var f=document.forms[0];
 	if (f.psk_obscure.checked == true) 
		f.wl_wpa_psk_2nd.value=f.wl_wpa_psk2.value;
 	else 
		f.wl_wpa_psk_2nd.value=f.wl_wpa_psk1.value;
}
function ChangeMode()
{

	
	f = document.forms[0];
	if(f.wl_security.value == "hotel") 
	{
			document.getElementById("div_hotel_1").style.display = "";
			document.getElementById("div_hotel_2").style.display = "";
			document.getElementById("div_wpa_psk00").style.display = "none";	
			document.getElementById("div_wpa_psk0").style.display = "none";	
			document.getElementById("div_wpa_psk1").style.display = "none";
			document.getElementById("div_wpa_psk2").style.display = "none";
			document.getElementById("div_wpa_psk3").style.display = "none";
			document.getElementById("div_wpa_psk4").style.display = "none";
			document.getElementById("div_wpa_psk5").style.display = "none";
			document.getElementById("div_wpa_psk6").style.display = "none";
			document.getElementById("div_wpa_psk7").style.display = "none";
			document.getElementById("div_wpa_psk8").style.display = "none";
	}
	else if(f.wl_security.value == "wpa") 
	{
			document.getElementById("div_hotel_1").style.display = "none";
			document.getElementById("div_hotel_2").style.display = "none";
			document.getElementById("div_wpa_psk00").style.display = "";	
			document.getElementById("div_wpa_psk0").style.display = "";	
			document.getElementById("div_wpa_psk1").style.display = "";
			document.getElementById("div_wpa_psk2").style.display = "";
			document.getElementById("div_wpa_psk3").style.display = "";
			document.getElementById("div_wpa_psk4").style.display = "";
			document.getElementById("div_wpa_psk5").style.display = "";
			document.getElementById("div_wpa_psk6").style.display = "";
			document.getElementById("div_wpa_psk7").style.display = "";
			document.getElementById("div_wpa_psk8").style.display = "";

			if (f.psk_obscure.checked == true) 
			{ 
				f.psk_obscure.checked = true;
				f.wl_wpa_psk2.value = f.wl_wpa_psk_2nd.value;
				document.getElementById("div_wpa_psk3").style.display = "none";
				document.getElementById("div_wpa_psk4").style.display = "none";
				document.getElementById("div_wpa_psk5").style.display = "";
				document.getElementById("div_wpa_psk6").style.display = "";
		
		
			}	
			else 
			{	
				f.psk_obscure.checked = false;
				f.wl_wpa_psk1.value = f.wl_wpa_psk_2nd.value;
				document.getElementById("div_wpa_psk3").style.display = "";
				document.getElementById("div_wpa_psk4").style.display = "";
				document.getElementById("div_wpa_psk5").style.display = "none";
				document.getElementById("div_wpa_psk6").style.display = "none";
			}	
	}

}
function Init_Value()
{
	var f=document.wireless_mssid;
	f.Clear_Changes.value=Clear_Changes;
	f.Apply_Changes.value=Apply_Changes;
	f.Radio.selectedIndex='<%nvram_get("wl0_mssid_enabled");%>';
	f.wl_ssid.value='<%nvram_get("wl0_ssid_2nd");%>';
	
	var obscured = '<%nvram_get("wl0_psk_obscured_2nd");%>';
	var encryption = '<%nvram_get("wl0_wpaenc_2nd");%>';
	var sec_mode = '<%nvram_get("wl0_sec_mode_2nd");%>';

	f.wl_wpa_psk_2nd.value='<%nvram_get("wl0_pskkey_2nd");%>';
	f.wl_psk_obscure_2nd.value='<%nvram_get("wl0_psk_obscured_2nd");%>';

	f.pskkey.value='<%nvram_get("wl0_hotel_key");%>';
	if (obscured=="1")
	{ 
		f.psk_obscure.checked = true;
		f.wl_wpa_psk2.value = f.wl_wpa_psk_2nd.value;

	}	
	else 
	{	
		f.psk_obscure.checked = false;
		f.wl_wpa_psk1.value = f.wl_wpa_psk_2nd.value;

	}	

	if (sec_mode=="WPA2")
		f.wl_auth.selectedIndex = 1;
	else if (sec_mode=="WPA1WPA2")
		f.wl_auth.selectedIndex = 0;
	else if (sec_mode=="psk")
		f.wl_auth.selectedIndex = 2;
	else
		f.wl_auth.selectedIndex = 0;

			
	if ( 'hotel' == '<%nvram_get("wl0_mssid_mode");%>' )
	{

			f.wl_security.selectedIndex = 0;
			document.getElementById("div_hotel_1").style.display = "";
			document.getElementById("div_hotel_2").style.display = "";
			document.getElementById("div_wpa_psk00").style.display = "none";	
			document.getElementById("div_wpa_psk0").style.display = "none";	
			document.getElementById("div_wpa_psk1").style.display = "none";
			document.getElementById("div_wpa_psk2").style.display = "none";
			document.getElementById("div_wpa_psk3").style.display = "none";
			document.getElementById("div_wpa_psk4").style.display = "none";
			document.getElementById("div_wpa_psk5").style.display = "none";
			document.getElementById("div_wpa_psk6").style.display = "none";
			document.getElementById("div_wpa_psk7").style.display = "none";
			document.getElementById("div_wpa_psk8").style.display = "none";

	}
	else 
	{
			f.wl_security.selectedIndex = 1;
			document.getElementById("div_hotel_1").style.display = "none";
			document.getElementById("div_hotel_2").style.display = "none";
			document.getElementById("div_wpa_psk00").style.display = "";	
			document.getElementById("div_wpa_psk0").style.display = "";	
			document.getElementById("div_wpa_psk1").style.display = "";
			document.getElementById("div_wpa_psk2").style.display = "";
			document.getElementById("div_wpa_psk3").style.display = "";
			document.getElementById("div_wpa_psk4").style.display = "";
			document.getElementById("div_wpa_psk5").style.display = "";
			document.getElementById("div_wpa_psk6").style.display = "";
			document.getElementById("div_wpa_psk7").style.display = "";
			document.getElementById("div_wpa_psk8").style.display = "";
		
			if (obscured=="1")
			{ 
				f.psk_obscure.checked = true;
				f.wl_wpa_psk2.value = f.wl_wpa_psk_2nd.value;
				document.getElementById("div_wpa_psk3").style.display = "none";
				document.getElementById("div_wpa_psk4").style.display = "none";
				document.getElementById("div_wpa_psk5").style.display = "";
				document.getElementById("div_wpa_psk6").style.display = "";
				
		
			}	
			else 
			{	
				f.psk_obscure.checked = false;
				f.wl_wpa_psk1.value = f.wl_wpa_psk_2nd.value;
				document.getElementById("div_wpa_psk3").style.display = "";
				document.getElementById("div_wpa_psk4").style.display = "";
				document.getElementById("div_wpa_psk5").style.display = "none";
				document.getElementById("div_wpa_psk6").style.display = "none";
				
			}	
			ChangeEncMode();
			modify();
			
	}
	

	
}
function ChangeEncMode()
{
	var i ,f ;
	
	f = document.forms[0];
	
	for( i = 0 ; i < f.wl_wep.options.length ; i++ )
		  f.wl_wep.options[i]=null;
	if( f.wl_auth.options[f.wl_auth.selectedIndex].value == 'psk' )
		  f.wl_wep.options[0] = new Option("TKIP",'1');		  
	else if( f.wl_auth.options[f.wl_auth.selectedIndex].value == 'WPA2' )
		  f.wl_wep.options[0] = new Option("AES",'0');		  
	else if( f.wl_auth.options[f.wl_auth.selectedIndex].value == 'WPA1WPA2' )
		  f.wl_wep.options[0] = new Option("TKIP+AES",'2');		  
 
}
function isBlank(s) {
 for(var i = 0; i < s.length; i++) {
 var c = s.charAt(i);
 if((c !=' ') && (c!='\n') && (c !='\t')) return false;
 }
 return true;
}

function Try_Submit()
{
	var f=document.forms[0];
	var plaintext_psk_v = document.getElementById('plaintext_psk');
	var obscure_psk_v = document.getElementById('obscure_psk');

	 change_psk();
 	f.wl0_mssid_enabled.value=f.Radio.selectedIndex;
	
	if(isBlank(f.wl_ssid.value)) 
 	{
		alert(wireless_chan4);	
		return false;
 	}

	for(i=0;i<f.wl_ssid.value.length;i++)
	{
		var token=f.wl_ssid.value.charAt(i);
		if(token=='`' || token=='~' || token=='!' || token=='@' || token=='#'
		|| token=='$' || token=='%' || token=='^' || token=='&' || token=='*'
		|| token=='(' || token==')' || token=='=' || token=='[' || token==','
		|| token==']' || token=='{' || token=='}' || token=='\\' || token=='|'
		|| token==';' || token==':' || token=='\'' || token=='\"' || token=='<'
		|| token=='>' || token=='/' || token=='?'  || token=='-')
		{
			alert(wireless_chan5a);
			return false;
		}	 
	}
			
	f.wl0_ssid_2nd.value=f.wl_ssid.value;


	f.wl0_mssid_mode.value=f.wl_security.value;
	
	if(f.wl_security.value=='hotel')
	{
			
			if (isBlank(f.pskkey.value))
			{ 
				alert(errm); 
				f.pskkey.focus();
				return false; 
			}
			
			if ( f.pskkey.value.length < 6 || f.pskkey.value.length > 32)
			{ 
				alert(vjs21);
				f.pskkey.focus();
				return false; 
			}
			

			f.wl0_hotel_key.value=f.pskkey.value;


	}
	else
	{

			if(isBlank(f.wl_wpa_psk_2nd.value))
			{
				alert(wwp6);
				return false;
			}
		
			if (f.wl_wpa_psk_2nd.value.length < 8 || f.wl_wpa_psk_2nd.value.length > 64)
			{
				alert(wwp7);
				return false;
			}
		
			if (f.wl_wpa_psk_2nd.value.length == 64)
			{
				if(!isHex(f.wl_wpa_psk_2nd.value))
				{
					alert(wwp7);
					return false;
				}
			}
		
			f.wl0_pskkey_2nd.value = f.wl_wpa_psk_2nd.value;		
			if (f.psk_obscure.checked == true) 
				f.wl0_psk_obscured_2nd.value = 1;
			else 
				f.wl0_psk_obscured_2nd.value = 0;
				
		
			f.wl0_wpaenc_2nd.value = f.wl_wep.value;
			//alert(f.wl_auth.value);
			f.wl0_sec_mode_2nd.value = f.wl_auth.value;
	}
	return true;
}


function modify()
{
	var f=document.forms[0];

	if (f.wl_psk_obscure_2nd.value==1)
	{
		f.wl_wpa_psk_2nd.value=f.wl_wpa_psk2.value;
	}
	else
	{
		f.wl_wpa_psk_2nd.value=f.wl_wpa_psk1.value;
	}


	if (f.psk_obscure.checked == true)
	{
		f.wl_wpa_psk2.value=f.wl_wpa_psk_2nd.value;
		document.getElementById("div_wpa_psk3").style.display = "none";
		document.getElementById("div_wpa_psk4").style.display = "none";
		document.getElementById("div_wpa_psk5").style.display = "";
		document.getElementById("div_wpa_psk6").style.display = "";
		f.wl_psk_obscure_2nd.value=1;
	}
	else 
	{
		f.wl_wpa_psk1.value=f.wl_wpa_psk_2nd.value;
		document.getElementById("div_wpa_psk3").style.display = "";
		document.getElementById("div_wpa_psk4").style.display = "";
		document.getElementById("div_wpa_psk5").style.display = "none";
		document.getElementById("div_wpa_psk6").style.display = "none";
		f.wl_psk_obscure_2nd.value=0;
	}
}

function change_psk()
{
	var f=document.forms[0];
 	if (f.psk_obscure.checked == true) 
		f.wl_wpa_psk_2nd.value=f.wl_wpa_psk2.value;
 	else 
		f.wl_wpa_psk_2nd.value=f.wl_wpa_psk1.value;
}

function isHex(s) {
var j,x = 0;
for(var i = 0; i < s.length; i++) {
var c = s.charAt(i);
j = parseInt(c,16);
if(isNaN(j))
  return false;
}
return true;
}
//-->
</SCRIPT>
</HEAD>
<BODY bgColor=#ffffff leftMargin=0 topMargin=0 onload="Init_Value();" marginheight="0" marginwidth="0">
<SCRIPT language=JavaScript>
	var wanStatus = '<%wan_status();%>';
	showHead(wanStatus,helpItem);
	showMenu(menuSection,menuItem,isAPmode)
</SCRIPT>
<form name="wireless_mssid" action="post.cgi" method="post">
<input type="hidden" name="command" value="device_data">
<input type="hidden" name="cur_ipaddr" value="<%nvram_get("lan_ipaddr");%>">
<input type="hidden" name="next_page" value="wireless_mssid.html">
<input type="hidden" name="redirect_timer" value="5000">
<input type="hidden" name="reboot" value="0">
<input type="hidden" name="restart" value="wireless">
<input type="hidden" name="data1" value="wl0_mssid_enabled wl0_ssid_2nd wl0_sec_mode_2nd wl0_psk_obscured_2nd wl0_pskkey_2nd wl0_wpaenc_2nd wl0_mssid_mode wl0_hotel_key">
<input type="hidden" name="wl0_mssid_enabled" value="<%nvram_get("wl0_mssid_enabled");%>">
<input type="hidden" name="wl0_ssid_2nd" value="<%nvram_get("wl0_ssid_2nd");%>" >
<input type="hidden" name="wl0_sec_mode_2nd" value="<%nvram_get("wl0_sec_mode_2nd");%>">
<input type="hidden" name="wl0_psk_obscured_2nd" value="<%nvram_get("wl0_psk_obscured_2nd");%>">
<input type="hidden" name="wl0_pskkey_2nd" value="<%nvram_get("wl0_pskkey_2nd");%>">
<input type="hidden" name="wl0_wpaenc_2nd" value="<%nvram_get("wl0_wpaenc_2nd");%>">
<input type="hidden" name="wl_wpa_psk_2nd" value="<%nvram_get("wl_wpa_psk_2nd");%>">
<input type="hidden" name="wl_psk_obscure_2nd" value="<%nvram_get("wl_psk_obscure_2nd");%>">
<input type="hidden" name="wl0_mssid_mode" value="<%nvram_get("wl0_mssid_mode");%>">
<input type="hidden" name="wl0_hotel_key" value="<%nvram_get("wl0_hotel_key");%>">

<TD class=head_bold height="100%" width="99%" valign="top"><BR>
&nbsp;&nbsp;
<span class="head_bold"><SCRIPT>dw(wireless_mssid_hotel1);</SCRIPT></span><BR>
<TABLE class=copy_1 border=0>
  <TBODY>
  <TR>
    <TD width=5>&nbsp;</TD>
    <TD>
      <table class="copy_1" border="0">
<tbody>
<tr>
<td width="5">&nbsp;</td>
<td>

<table class="copy_1" align="left" border="0" cellpadding="0" cellspacing="5" width="585">
<tbody>
<tr>
<td width="71">&nbsp;</td>
<td colspan="2">
<SCRIPT>dw(wireless_mssid_hotel2);</SCRIPT>
<a onclick="window.open('glossary.html#channel_ssid','help','toolbar=0,status=0,menubar=0,scrollbars=1,resizable=1,width=530,height=400,left=150,top=150');" href="javascript:void(0);"><b><font color="#6464c3">
</font></b></a></td>
</tr>
<tr>
<td width="71">&nbsp;</td>
<td width="174"><b>
<SCRIPT>dw(wireless_mssid_hotel3);</SCRIPT>
&gt;</b></td>
<td width="340">
  <select name="Radio">
    <option value="0"><SCRIPT>dw(Disabled);</SCRIPT></option>
    <option value="1"><SCRIPT>dw(Enabled);</SCRIPT></option>
  </select></td>
</tr>

<tr>
<td width="71">&nbsp;</td>
<td width="174"><b>
<SCRIPT>dw(wireless_mssid_hotel4);</SCRIPT>
&gt;</b> </td>
<td class="plaintext_bold" width="340">
<input maxlength="32" size="32" name="wl_ssid"> 
</td>
</tr>
<tr>
<td width="71">&nbsp;</td>
<td width="174"><b>
<SCRIPT>dw(wireless_mssid_hotel5);</SCRIPT>
&gt;</b></td>
<td width="340">
<select name="wl_security" onChange="ChangeMode();">
  <option value="hotel">
  <script>dw(wireless_mssid_hotel6);</script>
  </option>
  <option value="wpa">
  <script>dw(wireless_mssid_hotel7);  </script>

  </option>
</select>
&nbsp;
                    <A class=plaintext_bold 
                  onclick="window.open('glossary.html#guess_access','help','toolbar=0,status=0,menubar=0,scrollbars=1,resizable=1,width=530,height=400,left=150,top=150');" 
                  href="javascript:void(0);"><B><FONT color=#0066FF>
                  <SCRIPT>dw(sm1);</SCRIPT>
                  </FONT></B></A>
</td>
</tr>
<tr>
  <td></td>
  <td><div id="div_hotel_1"><b>
      <script>dw(PP);</script>
  </b> </div></td>
  <td><div id="div_hotel_2">
      <input maxlength="32" size="32" name="pskkey">
      <!--script>dw('<input type="button" style="{width:80px;}" class="submitBtn" name="wep128a_btn" size="15" value="'+generate+'" onClick="genkey()" >');</script-->
  </div></td>
</tr>
<tr>
<td width="71">&nbsp;</td>
<td width="174">
<div id="div_wpa_psk00">
<b>
  <script>dw(ww13);</script>
</b>
</div>
</td>
<td width="340">
<div id="div_wpa_psk0">
<select name="wl_auth" onchange="ChangeEncMode();">
  <option value="WPA1WPA2"><script>dw(WPA_PSK_WPA2_PSK);</script>
  <option value="WPA2"><script>dw(WPA2_PSK);</script></option>
  <option value="psk"><script>dw(WPA_PSK);</script></option>
  </option>
</select></div></td>
</tr>
<tr valign="top">
<td width="71"></td>
<td width="174"><div id="div_wpa_psk1"><b>
  <script>dw(ww3);</script>
</b></div></td>
<td width="340">
<div id="div_wpa_psk2">
<select name="wl_wep">
  <option value="0"><script>dw("TKIP+AES");</script></option>
</select></div>
</td></tr>
<tr >
  <td></td>
  <td><div id="div_wpa_psk3"><b>
    <script>dw(wwp2);</script>
  </b></div></td>
  <td><div id="div_wpa_psk4"><input maxlength="64" onchange="change_psk();" size="40" name="wl_wpa_psk1"></div></td>
</tr>

<tr>
<td width="71"></td>
<td width="174">
<div id="div_wpa_psk5">
<b>
  <script>dw(wwp2);</script>
</b></div>
</td>
<td width="340">
<div id="div_wpa_psk6">
<INPUT type=password maxLength=64 onchange=change_psk(); size=40 name=wl_wpa_psk2>
</div>
</td></tr>
<tr id=psk_comment name="psk_comment">
  <td></td>
  <td class="formText"></td>
  <td class="plaintext_bold">
<div id="div_wpa_psk7">
<b><span class="formText"><b>
    <input onclick="modify();" value="" name="psk_obscure" type="checkbox">
    <script>dw(wwp5);</script>
  </b></span>
    </b>
</div>
 </td>
</tr>
<tr id=psk_comment name="psk_comment">
  <td></td>
  <td class="formText"></td>
  <td class="plaintext_bold">
<div id="div_wpa_psk8">
	<b>
    <script>dw(wwp3);</script>
    </b><br>
    <script>dw(wwp4);</script>
</div>
 </td>
</tr>

<tr>
  <td></td>
  <td class="formText"><span class="plaintext_bold"><b>
    </b></span></td>
  <td class="plaintext_bold"><b>
    </b> </td>
</tr>
<tr>
<td colspan="3"><b>
  </b> </td>
</tr>
<tr>
<td width="71">&nbsp;</td>
<td colspan="2" align="center">
<input id="submitBtn_clear" value="" name="Clear_Changes" style="width: 160px;" class="submitBtn" onclick="Init_Value();" onmouseover="window.status='Clear'; return true;" onmouseout="window.status=''; return true;" type="button"><input id="submitBtn_apply"style="width: 160px;" value="" name="Apply_Changes" onclick="return Try_Submit();" class="submitBtn" type="submit"></td></tr></tbody></table></td></tr></tbody></table></BODY></HTML>
