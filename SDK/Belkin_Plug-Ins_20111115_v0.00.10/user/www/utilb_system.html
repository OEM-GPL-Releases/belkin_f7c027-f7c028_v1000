<HTML>
<HEAD>
<META HTTP-EQUIV="pragma" CONTENT="no-cache">
<META http-equiv=content-type content=text/html;charset=<%nvram_get("charset");%>>
<SCRIPT language=Javascript src="language_<%nvram_get("lang_code");%>.js"></SCRIPT>
<LINK href="styles.css" type=text/css rel=stylesheet>
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
<META HTTP-EQUIV="expires" CONTENT="0">
<SCRIPT language=JavaScript src="jquery-1.4.2.min.js"></SCRIPT>
<SCRIPT>assign_var();</SCRIPT>
<SCRIPT language=JavaScript src="showMenu.js"></SCRIPT>
<SCRIPT language=JavaScript src="validate.js"></SCRIPT>
<SCRIPT language=JavaScript src="md5.js"></SCRIPT>
<SCRIPT language=JavaScript>
<!--
var cty_lang_code='<%nvram_get("lang_code");%>';
function MakeArrayday(size) {
this.length = size;
for(var i = 1; i <= size; i++) this[i] = "";
return this;
}
function MakeArraymonth(size) {
this.length = size;
for(var i = 1; i <= size; i++) this[i] = "";
return this;
}

function redirect_URL(){
	document.location.href = 'home.html';
}
setTimeout('redirect_URL()', 600000);

//-->
</SCRIPT>
<SCRIPT>
strHtml='<title>'+str_540+'</title>';
dw(strHtml);
<!--
var helpItem 	='System Settings';
var menuSection	='Util';
var menuItem	='System Settings';
var isAPmode = ('<%nvram_get("wan_enabled");%>' == '0') ? '1' : '0';
<%autofw_check();%>
	

function Init_Value()
{
	var f=document.forms[0];
	var nat_enabled = '<%nvram_get("wan_enabled");%>';
	var login_timeout = '<%nvram_get("login_timeout");%>';
	var i;
	
	f.timeout.value = login_timeout;
	f.userOldPswd.value ="";
	f.userNewPswd.value ="";
	f.userConPswd.value ="";
	f.timeout.value ='<%nvram_get("login_timeout");%>';
	      
 	if( nat_enabled == '1') 
		f.wan_access[0].checked=true;
 	else 
		f.wan_access[1].checked=true; 

}

function storeData()
{
	var f=document.forms[0];
	var ori_mode = '<%nvram_get("wan_enabled");%>';
	var cur_ipaddr = '<%nvram_get("lan_ipaddr");%>';

	if (f.wan_access[0].checked==true)
		cur_ipaddr = '192.168.2.1';
		
	if (!(isBlank(f.userOldPswd.value) && isBlank(f.userNewPswd.value) && isBlank(f.userConPswd.value)))
		f.login_password.value = hex_md5(f.userNewPswd.value);
	
	f.login_timeout.value=f.timeout.value;
	
	if (f.wan_access[0].checked==true)
	{
		var alertmess=str_627+'(192.168.2.1).';
		f.wan_enabled.value = '1';
		f.lan_dhcps_enabled.value = '1';
		f.lan_ipaddr.value = cur_ipaddr;
		f.lan_netmask.value = '255.255.255.0';
		f.next_page.value = 'util_system.html';
	}
	else
	{
		var alertmess=str_627+'(192.168.2.254).'; 
		f.wan_enabled.value = '0';
		f.lan_dhcps_enabled.value = '0';
		f.lan_ipaddr.value = cur_ipaddr;
		f.lan_netmask.value = '255.255.255.0';
		f.next_page.value = 'utilb_system.html';
	}
	if (ori_mode=='1' && f.wan_access[1].checked==true)
		alert(alertmess);
	else if (ori_mode=='0' && f.wan_access[0].checked==true)	
		alert(alertmess);
		
	alert(str_1202);
	
	return true;
}

function isBlank(s) 
{
	for(i=0;i<s.length;i++) 
 	{
		c=s.charAt(i);
		if((c!=' ')&&(c!='\n')&&(c!='\t'))
			return false;
	}
 	return true;
}

function isNValidIP(s) 
{
 	if((isBlank(s))||(isNaN(s))||(s<0||s>255)) 
		return true;
 	else 
		return false;
}

function Try_Submit() 
{
	var f=document.forms[0];
	var tmp,i,c;
	
 	if(!(isBlank(f.userOldPswd.value) && isBlank(f.userNewPswd.value) && isBlank(f.userConPswd.value))) 
	{
 		if(hex_md5(f.userOldPswd.value)!=f.http_passwd.value)
 		{
			alert(str_623);
			return false;
 		}
 
 		if(f.userConPswd.value!=f.userNewPswd.value) 
 		{
			alert(str_624);
			return false;
 		}
		
		if (f.userNewPswd.value.length < 3 || f.userNewPswd.value.length > 16) 
		{ 
			alert(str_626); 
			return false;
		}
 	}
 
	ns = f.timeout.value;

	for (i=0;i<ns.length;i++)
    {
    	c=ns.charAt(i);
        if ((c<'0')||(c>'9'))
		{
			 alert(str_625);
			 return false;
		}	
	}
 	 if(eval(f.timeout.value)<1 || eval(f.timeout.value)>99)
 	{
		alert(str_625);
		return false;
 	}

 	if(storeData()==false)
		return false;
	
	return true;
}

function alertAdminPswd()
{
	var f = document.forms[0];
	
 	if(f.checkremote.checked == true) 
		alert(str_628);
}

function EnableDisableIPTextbox()
{
	var f=document.forms[0];
 	if(f.checkremote.checked == true)
 	{
		f.IP1.disabled = true;
		f.IP2.disabled = true;
		f.IP3.disabled = true;
		f.IP4.disabled = true;
 	}
 	else
 	{
		f.IP1.disabled = false;
		f.IP2.disabled = false;
		f.IP3.disabled = false;
		f.IP4.disabled = false;
 	}
}

//-->
</SCRIPT>
</HEAD>
<BODY bgColor=#ffffff leftMargin=0 topMargin=0 onload=Init_Value(); marginheight="0" marginwidth="0">
<SCRIPT language=JavaScript>
	var wanStatus = '<%wan_status();%>';
	showHead(wanStatus,helpItem,isAPmode);
	var friendly_name = '<%nvram_get("friendly_name");%>';
	showMenu(menuSection,menuItem,isAPmode, friendly_name)
</SCRIPT>
<form name="system" action="post.cgi" method="post">
<input type="hidden" name="command" value="device_data">
<input type="hidden" name="cur_ipaddr" value="<%nvram_get("lan_ipaddr");%>">
<input type="hidden" name="next_page" value="utilb_system.html">
<input type="hidden" name="redirect_timer" value="45000">
<input type="hidden" name="reboot" value="1">
<input type="hidden" name="data1" value="wan_enabled login_password login_timeout lan_dhcps_enabled lan_ipaddr lan_netmask">

<input type="hidden" name="http_passwd" value='<%nvram_get("login_password");%>'>
<input type="hidden" name="wan_enabled">
<input type="hidden" name="login_password" value='<%nvram_get("login_password");%>'>
<input type="hidden" name="login_timeout">
<input type="hidden" name="lan_dhcps_enabled">
<input type="hidden" name="lan_ipaddr"> 
<input type="hidden" name="lan_netmask">

 <TD class=head_bold height="100%" width="99%" valign="top"><BR>&nbsp;&nbsp;
<SCRIPT>dw(str_540);</SCRIPT>
 <BR><BR>
<TABLE class=copy_1 border=0>
  <TBODY>
  <TR>
    <TD width=5>&nbsp;</TD>
    <TD>
      <TABLE class=copy_1 cellSpacing=5 cellPadding=0 width=600 align=left 
      border=0>
        <TBODY>
        <TR>
          <TD colSpan=2 height=11><B>
            <SCRIPT>dw(str_541);</SCRIPT>
            </B></TD></TR>
        <TR>
          <TD colSpan=2 height=19>
            <SCRIPT>dw(str_542);</SCRIPT>
            <A 
            onclick="window.open('glossary.html#admin_password','help','toolbar=0,status=0,menubar=0,scrollbars=1,resizable=1,width=530,height=400,left=150,top=150');" 
            href="javascript:void(0);"><B><FONT color=#0066FF>
            <SCRIPT>dw(str_47);</SCRIPT>
            </FONT></B></A></TD></TR>
        <TR>
          <TD noWrap width=240 height=19>- <B><SPAN>
            <SCRIPT>dw(str_543);</SCRIPT>
            </SPAN>&gt;</B></TD>
          <TD class=plaintext_bold width=360 height=19>
		  	<INPUT type="password" name="userOldPswd" maxLength="12" size="15"></TD></TR>
        <TR>
          <TD width=240>- <B><SPAN>
            <SCRIPT>dw(str_544);</SCRIPT>
            </SPAN>&gt;</B></TD>
          <TD class=plaintext_bold width=360>
		  	<INPUT type="password" name="userNewPswd" maxLength="12" size="15"></TD></TR>
        <TR>
          <TD width=202><NOBR>- <B><SPAN>
            <SCRIPT>dw(str_545);</SCRIPT>
            </SPAN>&gt;</B></NOBR></TD>
          <TD class=plaintext_bold width=276>
		  	<INPUT type="password" name="userConPswd" maxLength="12" size="15" ></TD></TR>
        <TR>
          <TD width=202><SPAN>- </SPAN><B><SPAN>
            <SCRIPT>dw(str_546);</SCRIPT>
            </SPAN><SPAN>&gt; </SPAN></B></TD>
          <TD class=plaintext_bold width=276>
		  	<INPUT name="timeout" maxLength="2" size="4"> 
			<SPAN class=plaintext><SCRIPT>dw(str_547);</SCRIPT></SPAN>
		  </TD></TR>
<!--        <TR>
          <TD colSpan=2>
            <HR color=#666666 noShade SIZE=1>
          </TD></TR>
        <TR>
          <TD colSpan=2 height=26><B>
            <SCRIPT>dw(str_609);</SCRIPT>
            </B>
            <SCRIPT>dw(str_615);</SCRIPT>
            <A href="javascript:void(0);" onclick="window.open('glossary.html#nat','help','toolbar=0,status=0,menubar=0,scrollbars=1,resizable=1,width=530,height=400,left=150,top=150');">
		     <B><FONT color=#0066FF>
            <SCRIPT>dw(str_47);</SCRIPT>
            </FONT></B></A></TD></TR>
        <TR>
          <TD width=240>- <B><SPAN>
            <SCRIPT>dw(str_616);</SCRIPT>
            &gt;</SPAN></B></TD>
          <TD class=plaintext_bold width=360>
		  	<INPUT type="radio" name="wan_access">
            <SCRIPT>dw(str_71);</SCRIPT>
            <INPUT type="radio" name="wan_access">
            <SCRIPT>dw(str_119);</SCRIPT>
             </TD></TR>
        <TR>
          <TD colSpan=2>
            <HR color=#666666 noShade SIZE=1>
-->
 <INPUT type="hidden" name="wan_access">
 <INPUT type="hidden" name="wan_access">
 
        <TR>
          <TD width=202>&nbsp;</TD>
          <TD width=276>&nbsp;</TD></TR>
        <TR>
          <TD width=202>&nbsp;</TD>
          <TD align=middle width=316>
            <SCRIPT>
				dw('<input id="submitBtn_clear" type="reset" value="');
				dw(str_48);
				dw('" style="{width:150px;}" class="submitBtn" onclick="<!--f.reset();-->Init_Value();" onMouseOver="window.status=\'Clear\'; return true;" onMouseOut="window.status=\'\'; return true;">');
				dw('<input id="submitBtn_apply" type="submit" style="{width:150px;}" value="');
				dw(str_49);
				dw('" onClick="return Try_Submit();" class="submitBtn">');
			</SCRIPT>
          </TD>
		</TR></TBODY></TABLE></TD></TR></TBODY></TABLE></form></TD>
<SCRIPT language=JavaScript>showTail()</SCRIPT>
</BODY></HTML>
