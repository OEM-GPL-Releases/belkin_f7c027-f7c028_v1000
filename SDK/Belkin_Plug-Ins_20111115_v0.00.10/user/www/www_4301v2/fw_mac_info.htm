<html>
<head>
<title>Firewall &gt; MAC Address Filtering</title>
<meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
<LINK href="styles.css" type=text/css rel=stylesheet>
<SCRIPT language=Javascript src="util.js"></SCRIPT>
<SCRIPT language=Javascript src="language.js"></SCRIPT>
<SCRIPT>assign_var();</SCRIPT>
<SCRIPT language=JavaScript src="showMenu.js"></SCRIPT>
<script language="javascript">
<!-- hide
var helpItem 	='MAC Address Filtering';
var menuSection	='Fire';
var menuItem	='MAC Address Filtering';

var isAPmode = ('<%nvram_get("wan_enabled");%>' == '0') ? '1' : '0';

function addClick() {
   var loc = 'fw_mac.htm';

   window.location.href = loc;
}

function removeClick(rml) {
  document.forms[0].data1.value = "";
	if (document.forms[0].rml.length > 0) {
		for (i = 0; i < document.forms[0].rml.length; i++) {
			if ( document.forms[0].rml[i].checked == true ) {
				var j = document.forms[0].rml[i].value;
				eval("document.forms[0].mac_username" + j).value = "";
				eval("document.forms[0].mac_filter" + j).value = "00:00:00:00:00:00";
      	document.forms[0].data1.value += " mac_username" + j + " mac_filter" + j;
			}
		}
	}
	else if ( document.forms[0].rml.checked == true ) {
		var j = document.forms[0].rml.value;
		eval("document.forms[0].mac_username" + j).value = "";
		eval("document.forms[0].mac_filter" + j).value = "00:00:00:00:00:00";
		document.forms[0].data1.value = "mac_username" + j + " mac_filter" + j;
	}
	document.forms[0].submit();
}

function TodApply() {
  //var loc = 'sntpcfg.sntp?tod_enabled=';
	with( document.forms[0] ) {
  		data1.value = "mac_filter_enabled";
		if (todEnabled.checked)
			mac_filter_enabled.value = '1';
		else
			mac_filter_enabled.value = '0';
	}
	document.forms[0].submit();
}
function frmLoad() {
	var empty = 0;
	for ( i = 0; i < 40; i++ ) {
		if ( eval("document.forms[0].mac_username" + i).value != "" ) {
			empty = 1;
			break;
		}
	}
	if ( empty == 0 )
		window.location.href = "fw_mac.htm";
	if ( document.forms[0].mac_filter_enabled.value == '1')
		document.forms[0].todEnabled.checked = true;
	else
		document.forms[0].todEnabled.checked = false;
}
// done hiding -->
</script>
</head>
<BODY bgColor="#ffffff" leftMargin="0" topMargin="0" marginheight="0" marginwidth="0" onLoad="frmLoad()">
<form name="fw_mac" action="post.cgi" method="post">
<input type="hidden" name="command" value="device_data">
<input type="hidden" name="cur_ipaddr" value="<%nvram_get("lan_ipaddr");%>">
<input type="hidden" name="next_page" value="fw_mac_info.htm">
<input type="hidden" name="redirect_timer" value="30000">
<input type="hidden" name="reboot" value="1">
<input type="hidden" name="data1" value="">

<input type="hidden" name="mac_filter_enabled" value="<%nvram_get("mac_filter_enabled");%>">
<input type="hidden" name="mac_username0" value="<%nvram_get("mac_username0");%>">
<input type="hidden" name="mac_username1" value="<%nvram_get("mac_username1");%>">
<input type="hidden" name="mac_username2" value="<%nvram_get("mac_username2");%>">
<input type="hidden" name="mac_username3" value="<%nvram_get("mac_username3");%>">
<input type="hidden" name="mac_username4" value="<%nvram_get("mac_username4");%>">
<input type="hidden" name="mac_username5" value="<%nvram_get("mac_username5");%>">
<input type="hidden" name="mac_username6" value="<%nvram_get("mac_username6");%>">
<input type="hidden" name="mac_username7" value="<%nvram_get("mac_username7");%>">
<input type="hidden" name="mac_username8" value="<%nvram_get("mac_username8");%>">
<input type="hidden" name="mac_username9" value="<%nvram_get("mac_username9");%>">
<input type="hidden" name="mac_username10" value="<%nvram_get("mac_username10");%>">
<input type="hidden" name="mac_username11" value="<%nvram_get("mac_username11");%>">
<input type="hidden" name="mac_username12" value="<%nvram_get("mac_username12");%>">
<input type="hidden" name="mac_username13" value="<%nvram_get("mac_username13");%>">
<input type="hidden" name="mac_username14" value="<%nvram_get("mac_username14");%>">
<input type="hidden" name="mac_username15" value="<%nvram_get("mac_username15");%>">
<input type="hidden" name="mac_username16" value="<%nvram_get("mac_username16");%>">
<input type="hidden" name="mac_username17" value="<%nvram_get("mac_username17");%>">
<input type="hidden" name="mac_username18" value="<%nvram_get("mac_username18");%>">
<input type="hidden" name="mac_username19" value="<%nvram_get("mac_username19");%>">
<input type="hidden" name="mac_username20" value="<%nvram_get("mac_username20");%>">
<input type="hidden" name="mac_username21" value="<%nvram_get("mac_username21");%>">
<input type="hidden" name="mac_username22" value="<%nvram_get("mac_username22");%>">
<input type="hidden" name="mac_username23" value="<%nvram_get("mac_username23");%>">
<input type="hidden" name="mac_username24" value="<%nvram_get("mac_username24");%>">
<input type="hidden" name="mac_username25" value="<%nvram_get("mac_username25");%>">
<input type="hidden" name="mac_username26" value="<%nvram_get("mac_username26");%>">
<input type="hidden" name="mac_username27" value="<%nvram_get("mac_username27");%>">
<input type="hidden" name="mac_username28" value="<%nvram_get("mac_username28");%>">
<input type="hidden" name="mac_username29" value="<%nvram_get("mac_username29");%>">
<input type="hidden" name="mac_username30" value="<%nvram_get("mac_username30");%>">
<input type="hidden" name="mac_username31" value="<%nvram_get("mac_username31");%>">
<input type="hidden" name="mac_username32" value="<%nvram_get("mac_username32");%>">
<input type="hidden" name="mac_username33" value="<%nvram_get("mac_username33");%>">
<input type="hidden" name="mac_username34" value="<%nvram_get("mac_username34");%>">
<input type="hidden" name="mac_username35" value="<%nvram_get("mac_username35");%>">
<input type="hidden" name="mac_username36" value="<%nvram_get("mac_username36");%>">
<input type="hidden" name="mac_username37" value="<%nvram_get("mac_username37");%>">
<input type="hidden" name="mac_username38" value="<%nvram_get("mac_username38");%>">
<input type="hidden" name="mac_username39" value="<%nvram_get("mac_username39");%>">
<input type="hidden" name="mac_filter0" value="<%nvram_get("mac_filter0");%>">
<input type="hidden" name="mac_filter1" value="<%nvram_get("mac_filter1");%>">
<input type="hidden" name="mac_filter2" value="<%nvram_get("mac_filter2");%>">
<input type="hidden" name="mac_filter3" value="<%nvram_get("mac_filter3");%>">
<input type="hidden" name="mac_filter4" value="<%nvram_get("mac_filter4");%>">
<input type="hidden" name="mac_filter5" value="<%nvram_get("mac_filter5");%>">
<input type="hidden" name="mac_filter6" value="<%nvram_get("mac_filter6");%>">
<input type="hidden" name="mac_filter7" value="<%nvram_get("mac_filter7");%>">
<input type="hidden" name="mac_filter8" value="<%nvram_get("mac_filter8");%>">
<input type="hidden" name="mac_filter9" value="<%nvram_get("mac_filter9");%>">
<input type="hidden" name="mac_filter10" value="<%nvram_get("mac_filter10");%>">
<input type="hidden" name="mac_filter11" value="<%nvram_get("mac_filter11");%>">
<input type="hidden" name="mac_filter12" value="<%nvram_get("mac_filter12");%>">
<input type="hidden" name="mac_filter13" value="<%nvram_get("mac_filter13");%>">
<input type="hidden" name="mac_filter14" value="<%nvram_get("mac_filter14");%>">
<input type="hidden" name="mac_filter15" value="<%nvram_get("mac_filter15");%>">
<input type="hidden" name="mac_filter16" value="<%nvram_get("mac_filter16");%>">
<input type="hidden" name="mac_filter17" value="<%nvram_get("mac_filter17");%>">
<input type="hidden" name="mac_filter18" value="<%nvram_get("mac_filter18");%>">
<input type="hidden" name="mac_filter19" value="<%nvram_get("mac_filter19");%>">
<input type="hidden" name="mac_filter20" value="<%nvram_get("mac_filter20");%>">
<input type="hidden" name="mac_filter21" value="<%nvram_get("mac_filter21");%>">
<input type="hidden" name="mac_filter22" value="<%nvram_get("mac_filter22");%>">
<input type="hidden" name="mac_filter23" value="<%nvram_get("mac_filter23");%>">
<input type="hidden" name="mac_filter24" value="<%nvram_get("mac_filter24");%>">
<input type="hidden" name="mac_filter25" value="<%nvram_get("mac_filter25");%>">
<input type="hidden" name="mac_filter26" value="<%nvram_get("mac_filter26");%>">
<input type="hidden" name="mac_filter27" value="<%nvram_get("mac_filter27");%>">
<input type="hidden" name="mac_filter28" value="<%nvram_get("mac_filter28");%>">
<input type="hidden" name="mac_filter29" value="<%nvram_get("mac_filter29");%>">
<input type="hidden" name="mac_filter30" value="<%nvram_get("mac_filter30");%>">
<input type="hidden" name="mac_filter31" value="<%nvram_get("mac_filter31");%>">
<input type="hidden" name="mac_filter32" value="<%nvram_get("mac_filter32");%>">
<input type="hidden" name="mac_filter33" value="<%nvram_get("mac_filter33");%>">
<input type="hidden" name="mac_filter34" value="<%nvram_get("mac_filter34");%>">
<input type="hidden" name="mac_filter35" value="<%nvram_get("mac_filter35");%>">
<input type="hidden" name="mac_filter36" value="<%nvram_get("mac_filter36");%>">
<input type="hidden" name="mac_filter37" value="<%nvram_get("mac_filter37");%>">
<input type="hidden" name="mac_filter38" value="<%nvram_get("mac_filter38");%>">
<input type="hidden" name="mac_filter39" value="<%nvram_get("mac_filter39");%>">
<input type="hidden" name="mac_filter_type0" value="<%nvram_get("mac_filter_type0");%>">
<input type="hidden" name="mac_filter_type1" value="<%nvram_get("mac_filter_type1");%>">
<input type="hidden" name="mac_filter_type2" value="<%nvram_get("mac_filter_type2");%>">
<input type="hidden" name="mac_filter_type3" value="<%nvram_get("mac_filter_type3");%>">
<input type="hidden" name="mac_filter_type4" value="<%nvram_get("mac_filter_type4");%>">
<input type="hidden" name="mac_filter_type5" value="<%nvram_get("mac_filter_type5");%>">
<input type="hidden" name="mac_filter_type6" value="<%nvram_get("mac_filter_type6");%>">
<input type="hidden" name="mac_filter_type7" value="<%nvram_get("mac_filter_type7");%>">
<input type="hidden" name="mac_filter_type8" value="<%nvram_get("mac_filter_type8");%>">
<input type="hidden" name="mac_filter_type9" value="<%nvram_get("mac_filter_type9");%>">
<input type="hidden" name="mac_filter_type10" value="<%nvram_get("mac_filter_type10");%>">
<input type="hidden" name="mac_filter_type11" value="<%nvram_get("mac_filter_type11");%>">
<input type="hidden" name="mac_filter_type12" value="<%nvram_get("mac_filter_type12");%>">
<input type="hidden" name="mac_filter_type13" value="<%nvram_get("mac_filter_type13");%>">
<input type="hidden" name="mac_filter_type14" value="<%nvram_get("mac_filter_type14");%>">
<input type="hidden" name="mac_filter_type15" value="<%nvram_get("mac_filter_type15");%>">
<input type="hidden" name="mac_filter_type16" value="<%nvram_get("mac_filter_type16");%>">
<input type="hidden" name="mac_filter_type17" value="<%nvram_get("mac_filter_type17");%>">
<input type="hidden" name="mac_filter_type18" value="<%nvram_get("mac_filter_type18");%>">
<input type="hidden" name="mac_filter_type19" value="<%nvram_get("mac_filter_type19");%>">
<input type="hidden" name="mac_filter_type20" value="<%nvram_get("mac_filter_type20");%>">
<input type="hidden" name="mac_filter_type21" value="<%nvram_get("mac_filter_type21");%>">
<input type="hidden" name="mac_filter_type22" value="<%nvram_get("mac_filter_type22");%>">
<input type="hidden" name="mac_filter_type23" value="<%nvram_get("mac_filter_type23");%>">
<input type="hidden" name="mac_filter_type24" value="<%nvram_get("mac_filter_type24");%>">
<input type="hidden" name="mac_filter_type25" value="<%nvram_get("mac_filter_type25");%>">
<input type="hidden" name="mac_filter_type26" value="<%nvram_get("mac_filter_type26");%>">
<input type="hidden" name="mac_filter_type27" value="<%nvram_get("mac_filter_type27");%>">
<input type="hidden" name="mac_filter_type28" value="<%nvram_get("mac_filter_type28");%>">
<input type="hidden" name="mac_filter_type29" value="<%nvram_get("mac_filter_type29");%>">
<input type="hidden" name="mac_filter_type30" value="<%nvram_get("mac_filter_type30");%>">
<input type="hidden" name="mac_filter_type31" value="<%nvram_get("mac_filter_type31");%>">
<input type="hidden" name="mac_filter_type32" value="<%nvram_get("mac_filter_type32");%>">
<input type="hidden" name="mac_filter_type33" value="<%nvram_get("mac_filter_type33");%>">
<input type="hidden" name="mac_filter_type34" value="<%nvram_get("mac_filter_type34");%>">
<input type="hidden" name="mac_filter_type35" value="<%nvram_get("mac_filter_type35");%>">
<input type="hidden" name="mac_filter_type36" value="<%nvram_get("mac_filter_type36");%>">
<input type="hidden" name="mac_filter_type37" value="<%nvram_get("mac_filter_type37");%>">
<input type="hidden" name="mac_filter_type38" value="<%nvram_get("mac_filter_type38");%>">
<input type="hidden" name="mac_filter_type39" value="<%nvram_get("mac_filter_type39");%>">
<SCRIPT language=JavaScript>
	var wanStatus = '<%wan_status();%>';
	showHead(wanStatus,helpItem);
	var friendly_name = '<%nvram_get("friendly_name");%>';
	showMenu(menuSection,menuItem,isAPmode, friendly_name);
</SCRIPT>
 <TD class=head_bold height="100%" width="100%" valign="top"><BR>&nbsp;&nbsp;
 <table height="100%" width="100%">
 	<tr>
 		<td width="4%"></td>
 		<td valign="top">
<font face='Verdana'><b><font color='#003399' size='2'><b>Firewall > MAC Address Filtering</b></font><br><br>
<font face='Verdana'><b><font color='#004263' size='1'>This feature lets you set up a list of allowed clients. When you enable this feature, you must enter the</font><br>
<font face='Verdana'><b><font color='#004263' size='1'>MAC address of each client on your network access to each.</font><a style='text-decoration: none' href='javascript:void(0);' onclick=window.open('help.html#TOD','help','toolbar=0,status=0,menubar=0,scrollbars=1,resizable=1,width=640,height=400,left=150,top=150');>
<font face='Verdana' size='1' color='#6464C3'>More Info</font><br>
</a><br>

<b><font face='Verdana' size='1' color='#004263'>Enable MAC Address Filtering <input type='checkbox' name='todEnabled'></font>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<font color='#004263' size='1' face='Verdana'><input type='button' value='Apply Changes' style='height:22px;width:120px;background-color:#006699;color:#FFFFFF;border-style:solid; border-color:#006699;' onClick='TodApply()'  class='submitBtn'></font><br><br><br><center>
<table border='1' cellpadding='4' cellspacing='0'>
   <tr>
      <td class='hd' style='background-color: #006699' bordercolor='#FFFFFF'><font color='#FFFFFF' face='Verdana' size='2'>Username</font></td>
      <td class='hd' style='background-color: #006699' bordercolor='#FFFFFF'><font color='#FFFFFF' face='Verdana' size='2'>MAC</font></td>
      <td class='hd' style='background-color: #006699' bordercolor='#FFFFFF'><font color='#FFFFFF' face='Verdana' size='2'>Remove</font></td>
   </tr>
<script>
	count=0;
	while(count<=39)
	{
		if ( eval("document.forms[0].mac_username" + count).value != "" ) {
    	document.write("<tr>\n");
      document.write("<td style='background-color: #99CCFF' bordercolor='#FFFFFF'><font face='Verdana' color='#000000' size='2'>" + eval("document.forms[0].mac_username" + count).value + "</font></td>\n");
      document.write("<td style='background-color: #99CCFF' bordercolor='#FFFFFF'><font face='Verdana' color='#000000' size='2'>" + eval("document.forms[0].mac_filter" + count).value + "</font></td>\n");
      document.write("<td style='background-color: #99CCFF' bordercolor='#FFFFFF' align='center'><font face='Verdana' color='#000000' size='2'><input type='checkbox' name='rml' value='" + count + "'></font></td>\n");
      document.write("</tr>\n");
		}
		count++;
	}
</script>
</table><br>
<input type='button' style='height:22px;background-color:#006699;color:#FFFFFF;border-style:solid; border-color:#006699;width:120px;' onClick='addClick()' value='Add' class='submitBtn'>
<input type='button' style='height:22px;background-color:#006699;color:#FFFFFF;border-style:solid; border-color:#006699;width:120px;' onClick='removeClick(this.form.rml)' value='Remove' class='submitBtn'>
</center>
			</td>
		</tr>
	</table>
</TD>
</form>
</BODY>
</html>
